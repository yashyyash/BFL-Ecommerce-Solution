<div class="container my-5">
  <div class="row">
    @if (cart().length > 0) {
      <!-- Cart Items List (Left Side) -->
      <div class="col-lg-8">
        <h2 class="mb-4">Your Shopping Cart</h2>
        @for (item of cart(); track item.product._id) {
          <div class="card mb-3">
            <div class="row g-0">
              <div class="col-md-2">
                <img 
                  [src]="item.product.images[0] || 'https://placehold.co/150x150'" 
                  class="img-fluid rounded-start" 
                  [alt]="item.product.name"
                  style="width: 100%; height: 120px; object-fit: cover;"
                >
              </div>
              <div class="col-md-7">
                <div class="card-body">
                  <h5 class="card-title">{{ item.product.name }}</h5>
                  <p class="card-text text-muted">{{ item.product.brand }}</p>
                  <p class="card-text">
                    <strong>${{ item.product.price | number:'1.2-2' }}</strong>
                  </p>
                </div>
              </div>
              <div class="col-md-3 d-flex flex-column align-items-center justify-content-center p-3">
                <!-- Quantity Selector -->
                <select 
                  class="form-select form-select-sm mb-2" 
                  [value]="item.quantity"
                  (change)="updateQuantity(item.product._id, $event)"
                >
                  @for (q of [1,2,3,4,5,6,7,8,9,10]; track q) {
                    <option [value]="q">{{q}}</option>
                  }
                  @if (item.quantity > 10) {
                    <option [value]="item.quantity">{{item.quantity}} (Current)</option>
                  }
                </select>
                <!-- Remove Button -->
                <button class="btn btn-sm btn-outline-danger" (click)="removeItem(item.product._id)">
                  Remove
                </button>
              </div>
            </div>
          </div>
        }
        <button class="btn btn-danger mt-3" (click)="clearCart()">
          Clear Entire Cart
        </button>
      </div>

      <!-- Order Summary (Right Side) -->
      <div class="col-lg-4">
        <div class="card shadow-sm" style="position: sticky; top: 100px;">
          <div class="card-body">
            <h4 class="card-title">Order Summary</h4>
            <ul class="list-group list-group-flush">
              <li class="list-group-item d-flex justify-content-between align-items-center">
                Subtotal
                <span>${{ totalPrice() | number:'1.2-2' }}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                Shipping
                <span class="text-success">FREE</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center fw-bold">
                Total
                <span>${{ totalPrice() | number:'1.2-2' }}</span>
              </li>
            </ul>
            <a [routerLink]="['/checkout']" class="btn btn-success w-100 mt-4"> Proceed to Checkout</a>
            <p class="text-muted text-center small mt-2">
              You will be asked to sign in at the next step.
            </p>
          </div>
        </div>
      </div>
    } @else {
      <!-- Empty Cart View -->
      <div class="col-12 text-center">
        <div class="card p-5">
          <div class="card-body">
            <h2 class="card-title">Your Cart is Empty</h2>
            <p class="card-text">Looks like you haven't added anything to your cart yet.</p>
            <a [routerLink]="['/products']" class="btn btn-primary">Start Shopping</a>
          </div>
        </div>
      </div>
    }
  </div>
</div>